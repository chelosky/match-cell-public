<ngx-spinner type = "timer">
    <p style="color: white" > Loading... </p>
</ngx-spinner>
<!-- HEADER -->
<div class="row home-container">
    <div class="col-md-12 text-center mt-3">
        <h2>TWITTER</h2>
    </div>
</div>
<!-- CONTENT PAGE -->
<div class="row home-container">
    <div class="col-md-3 text-center">

        <!-- TOKEN INPUT -->
        <div class="form-group row">
            <label class="col-md-12 text-center col-form-label">
                <strong>Token</strong>
            </label>
            <div class="input-group">
                <input 
                type="text" 
                class="form-control" 
                id="sequeNew"
                [(ngModel)]="newSequence"
                (keydown.enter)="addSequence()"
                placeholder="abcd">
                <div *ngIf="availableColors.length != 0" class="input-group-append">
                    <span class="input-group-text" style="height: 100%;">
                        <input type="checkbox" [(ngModel)]="_formatPattern">
                    </span>
                </div>
            </div>
        </div>

        <div class="row" >
            <div class="col-12 text-end">
                <mat-checkbox color="primary" class="text-right" [(ngModel)]="_regexActivate">Regex</mat-checkbox>
            </div>
        </div>

        <!-- TOKEN LIST -->
        <div *ngIf="availableColors.length != 0">
            <div class="text-center my-3">
                <strong>Token List</strong>
            </div>
            <!-- class="mat-chip-list-stacked" -->
            <mat-chip-list >
                <mat-chip 
                *ngFor="let chip of availableColors" 
                selectable 
                removable
                (removed)="remove(chip.name)"
                >
                    {{(!_formatPattern)?chip.name:chip.pattern}}
                    <mat-icon  matChipRemove>cancel</mat-icon>
                </mat-chip>
            </mat-chip-list>
        </div>
    
        <div class="dropdown-divider my-3"></div>
    
        <!-- DEBUG INFO -->
        <p class="text-center"><strong>DEBUG INFORMATION</strong></p>

        <ul class="list-group">
            <li>New Tweet In
                <span class="badge">{{timerGenerate}}</span>
            </li>
            <li>Total Tweets
                <span class="badge">{{tweetList.length}}</span>
            </li>
            <li>Total Matchs
                <span class="badge">{{getMatches()}}</span>
            </li>
        </ul>
        
        <div class="dropdown-divider my-3"></div>

        <!-- TOKEN INPUT -->
        <div class="form-group row">
            <label class="col-md-12 text-center col-form-label">
                <strong>Timer Generator</strong>
            </label>
            <div class="input-group">
                <input 
                type="number" 
                class="form-control" 
                id="timer"
                min="5"
                [(ngModel)]="newTimer"
                placeholder="0">
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <button
                class="my-2"
                mat-raised-button
                (click)="setTimerGenerator()"
                [disabled]="!newTimer || newTimer < 1"
                color="primary">
                    <mat-icon >save</mat-icon>
                    Set New Timer
                </button>
            </div>
            <div class="col-md-12">
                <button
                class="my-2"
                mat-raised-button 
                (click)="generateTweet()" 
                color="primary">
                    <mat-icon >refresh</mat-icon>
                    Generate New Tweet
                </button>
            </div>
        </div>

    </div>
    <!-- LIST TWEET -->
    <div class="col-md-5 tweet-list">
        <app-tweet
        *ngFor="let item of tweetList"
        [username]="item.username"
        [content]="item.content"
        [hashtags]="item.hashtag"
        [match]="item.match"
        [total]="item.total"
        ></app-tweet>
    </div>
    <!-- CONFIGURATION OPTIONS -->
    <div class="col-md-4">
        <div class="text-center">
            <strong>RULES</strong>
        </div>

        <div class="dropdown-divider my-3"></div>

        <mat-card>

            <mat-card-title class="title-card">
                Cell Evolution Rules
            </mat-card-title>
        
            <mat-card-content>
                <mat-radio-group
                    aria-labelledby="example-radio-group-label"
                    class="example-radio-group"
                    color="primary"
                    [(ngModel)]="favoriteSeason">
                    <mat-radio-button class="example-radio-button" *ngFor="let season of seasons" [value]="season">
                        <strong>{{season}}</strong>
                    </mat-radio-button>
                </mat-radio-group>
            </mat-card-content>
        </mat-card>

        <div class="dropdown-divider my-3"></div>

        <mat-card>

            <mat-card-title class="title-card">
                Solution Evolution Rules
            </mat-card-title>
        
            <button mat-icon-button class="more-button" (click)="openAddRuleDialog()">
                <mat-icon>add</mat-icon>
            </button>

            <mat-card-content>
                <mat-list>

                    <mat-list-item>
                        <mat-checkbox
                        color="primary"
                        [(ngModel)]="master_checked"
                        [(indeterminate)]="master_indeterminate"
                        (change)="master_change()"
                        >
                            <strong>Check/ Uncheck All</strong>
                        </mat-checkbox>
                    </mat-list-item>
            
                    <mat-list-item 
                    style="margin-left: 1rem;"
                    *ngFor="let item of checkbox_list; let i = index">
                        <mat-checkbox
                        color="primary"
                        [(ngModel)]="item.checked"
                        [disabled]="item.disabled"
                        [labelPosition]="item.labelPosition"
                        (change)="list_change()"
                        >
                            <strong>{{ item.name }}</strong>
                        </mat-checkbox>
                        <button *ngIf="item.deletable" mat-icon-button class="delete-button">
                            <mat-icon>delete</mat-icon>
                        </button>
                    </mat-list-item>
            
                </mat-list>
            </mat-card-content>
        </mat-card>

        <div class="dropdown-divider my-3"></div>

        <div class="row">
            <div class="col-md-12 text-center">
                <button
                    class="col-md-8"
                    mat-raised-button 
                    [disabled]="availableColors.length == 0 || _match_in_process"
                    (click)="matchProcess()" 
                    color="primary"
                >
                    <mat-icon > account_tree </mat-icon>
                    Match It!
                </button>
            </div>
        </div>
    </div>
</div>